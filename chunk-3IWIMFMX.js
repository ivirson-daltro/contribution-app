import{c as i,h as u}from"./chunk-JM3QEYPJ.js";import{W as t}from"./chunk-JN5EMR2A.js";var D=(E,r)=>{let o=t(u),e=t(i);if(!o.isAuthenticated())return e.navigate(["/auth/login"],{queryParams:{returnUrl:r.url}}),!1;let s=localStorage.getItem("user"),n=s?JSON.parse(s):null;if(!n)return o.logout(),e.navigate(["/auth/login"]),!1;let a={"/":["ADMIN","TREASURER","SECRETARY","PRESIDENT","FISCAL"],"/members":["ADMIN","TREASURER","SECRETARY","PRESIDENT","FISCAL"],"/users":["ADMIN"],"/contributions":["ADMIN","FISCAL","TREASURER","PRESIDENT"],"/expenses":["ADMIN","FISCAL","TREASURER","PRESIDENT"]},R=r.url.split("?")[0],l=R.split("/")[1]?`/${R.split("/")[1]}`:"/";return(a[l]||["ADMIN","TREASURER","SECRETARY","PRESIDENT","FISCAL"]).includes(n.role)?!0:(e.navigate(["/"]),!1)};export{D as a};
