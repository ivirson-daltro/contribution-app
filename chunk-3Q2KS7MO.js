import{b as N}from"./chunk-VZNXFT7U.js";import{c as M,e as l,g as S,h as O,l as k,n as x,o as E,s as R,u as V}from"./chunk-GFUDPGUP.js";import{a as P,c as y,h as F}from"./chunk-2F2UWFXG.js";import{a as T,b as A}from"./chunk-7WCVQ4OW.js";import"./chunk-QK5Q5MQS.js";import{E as g,Ia as b,W as m,Wa as w,Xa as v,ab as d,bb as t,cb as o,db as c,jb as p,jc as C,wb as _,ya as n,yb as r,zb as f}from"./chunk-3U63YFDR.js";import"./chunk-7CGTOI24.js";function j(u,a){u&1&&(t(0,"div",17),r(1,"As senhas n\xE3o coincidem."),o())}var I=class u{fb=m(R);router=m(y);route=m(P);authService=m(F);toastService=m(N);form;hidePassword=!0;hideConfirmPassword=!0;togglePasswordVisibility(){this.hidePassword=!this.hidePassword}toggleConfirmPasswordVisibility(){this.hideConfirmPassword=!this.hideConfirmPassword}ngOnInit(){this.buildForm(),this.form.get("confirmPassword")?.valueChanges.subscribe(()=>{console.log(this.form)})}buildForm(){this.form=this.fb.group({email:["",[l.required,l.email]],password:["",[l.required,l.minLength(6)]],confirmPassword:["",[l.required]]},{validators:this.passwordMatchValidator})}passwordMatchValidator=a=>{let i=a.get("password")?.value,e=a.get("confirmPassword")?.value;return i&&e&&i!==e?{passwordMismatch:!0}:null};getTokenFromRoute(){return this.route.snapshot.params.token||""}submit(){if(this.form.invalid){this.form.markAllAsTouched();return}let{password:a}=this.form.getRawValue(),i=this.getTokenFromRoute();this.authService.resetPassword(i,a).pipe(g()).subscribe({next:()=>{this.toastService.success("Senha resetada com sucesso. Voc\xEA j\xE1 pode fazer login com a nova senha."),this.router.navigate(["/auth/login"])},error:e=>{this.toastService.error(e.error.error||"Erro desconhecido","Erro ao resetar senha")}})}static \u0275fac=function(i){return new(i||u)};static \u0275cmp=b({type:u,selectors:[["app-reset-password"]],decls:35,vars:9,consts:[[1,"auth-page","d-flex","align-items-center","justify-content-center"],[1,"auth-card"],[1,"auth-icon-wrapper"],["src","images/logo.png","alt","Logo da igreja"],[1,"auth-title"],[1,"auth-subtitle"],[1,"auth-form",3,"ngSubmit","formGroup"],[1,"mb-3"],[1,"form-label"],["type","email","placeholder","seu@email.com","formControlName","email",1,"form-control"],[1,"row","mb-3"],[1,"col-12","col-md-12"],[1,"position-relative"],["placeholder","M\xEDnimo 6 caracteres","formControlName","password",1,"form-control","pr-5",3,"type"],["type","button","tabindex","-1",1,"btn","btn-sm","btn-link","password-toggle",3,"click"],[1,"row","my-3"],["placeholder","Repita a senha","formControlName","confirmPassword",1,"form-control","pr-5",3,"blur","input","type"],[1,"invalid-feedback"],["type","submit",1,"btn","btn-primary","auth-submit-btn","w-100","mt-3",3,"disabled"],["fontIcon","lock_reset",1,"me-2"]],template:function(i,e){if(i&1&&(t(0,"div",0)(1,"div",1)(2,"div",2),c(3,"img",3),o(),t(4,"h1",4),r(5,"Redefinir Senha"),o(),t(6,"p",5),r(7,"Crie uma nova senha para acessar o sistema"),o(),t(8,"form",6),p("ngSubmit",function(){return e.submit()}),t(9,"div",7)(10,"label",8),r(11,"Email"),o(),c(12,"input",9),o(),t(13,"div",10)(14,"div",11)(15,"label",8),r(16,"Senha"),o(),t(17,"div",12),c(18,"input",13),t(19,"button",14),p("click",function(){return e.togglePasswordVisibility()}),t(20,"mat-icon"),r(21),o()()()()(),t(22,"div",15)(23,"div",11)(24,"label",8),r(25,"Confirmar Senha"),o(),t(26,"div",12)(27,"input",16),p("blur",function(){let h;return(h=e.form.get("confirmPassword"))==null||h.markAsTouched(),e.form.updateValueAndValidity()})("input",function(){return e.form.updateValueAndValidity()}),o(),t(28,"button",14),p("click",function(){return e.toggleConfirmPasswordVisibility()}),t(29,"mat-icon"),r(30),o()()(),w(31,j,2,0,"div",17),o()(),t(32,"button",18),c(33,"mat-icon",19),r(34," Redefinir Senha "),o()()()()),i&2){let s;n(8),d("formGroup",e.form),n(10),d("type",e.hidePassword?"password":"text"),n(3),f(e.hidePassword?"visibility_off":"visibility"),n(6),_("is-invalid",e.form.hasError("passwordMismatch")&&((s=e.form.get("confirmPassword"))==null?null:s.touched)),d("type",e.hideConfirmPassword?"password":"text"),n(3),f(e.hideConfirmPassword?"visibility_off":"visibility"),n(),v(e.form.hasError("passwordMismatch")?31:-1),n(),d("disabled",e.form.invalid)}},dependencies:[C,V,k,M,S,O,E,x,A,T],styles:[".form-control.is-invalid[_ngcontent-%COMP%]{border-color:#dc3545!important;box-shadow:0 0 0 1px #dc354533;background-image:none!important}.invalid-feedback[_ngcontent-%COMP%]{display:block;color:#dc3545;font-size:.85rem;margin-top:.25rem}.password-toggle[_ngcontent-%COMP%]{min-width:2rem;color:#6b7280;background:none;border:none;outline:none;cursor:pointer;position:absolute;right:.5rem;top:50%;transform:translateY(-50%);z-index:2}.auth-page[_ngcontent-%COMP%]{min-height:100vh;background:radial-gradient(circle at top left,#e5edf9 0,#f3f4f6 45%,#fff);padding:2rem 1rem}.auth-card[_ngcontent-%COMP%]{width:100%;max-width:460px;background-color:#fff;border-radius:1.25rem;box-shadow:0 18px 45px #0f172a1f;padding:2.25rem 2.5rem 2.5rem}.auth-icon-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-bottom:1.5rem}.auth-icon-wrapper[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:40px}.auth-title[_ngcontent-%COMP%]{text-align:center;font-size:1.35rem;font-weight:700;color:#0b2454;margin-bottom:.25rem}.auth-subtitle[_ngcontent-%COMP%]{text-align:center;font-size:.9rem;color:#6b7280;margin-bottom:1.75rem}.auth-form[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]{font-size:.85rem;font-weight:600;color:#374151}.auth-form[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{border-radius:.75rem;border-color:#d1d5db;padding:.65rem .9rem}.auth-form[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:focus{border-color:#1d4ed8;box-shadow:0 0 0 1px #2563eb40}.auth-submit-btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;gap:.4rem;height:2.9rem;border-radius:.625rem;background-color:#0b2454;border-color:#0b2454;font-weight:600}.auth-submit-btn[_ngcontent-%COMP%]:disabled{opacity:.7}a[_ngcontent-%COMP%]{text-decoration:none}@media(max-width:576px){.auth-card[_ngcontent-%COMP%]{padding:1.75rem 1.5rem 2rem}}"]})};export{I as ResetPasswordComponent};
