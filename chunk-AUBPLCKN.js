import{a as fe,d as me}from"./chunk-MUXJUY4Y.js";import{Ca as ne,Hb as oe,Ka as le,La as he,R as q,U as Z,Vb as ue,W as T,Wb as d,Zb as X,ca as Q,fa as ie,ka as R,kb as ce,la as J,ma as j,na as se,oa as re,qa as ae}from"./chunk-2AFPZVH2.js";import{a as A,b as ee,c as te}from"./chunk-7CGTOI24.js";var i=(function(c){return c.SEPARATOR="separator",c.PERCENT="percent",c.IP="IP",c.CPF_CNPJ="CPF_CNPJ",c.MONTH="M",c.MONTHS="M0",c.MINUTE="m",c.HOUR="h",c.HOURS="H",c.MINUTES="m0",c.HOURS_HOUR="Hh",c.SECONDS="s0",c.HOURS_MINUTES_SECONDS="Hh:m0:s0",c.EMAIL_MASK="A*@A*.A*",c.HOURS_MINUTES="Hh:m0",c.MINUTES_SECONDS="m0:s0",c.DAYS_MONTHS_YEARS="d0/M0/0000",c.DAYS_MONTHS="d0/M0",c.DAYS="d0",c.DAY="d",c.SECOND="s",c.LETTER_S="S",c.DOT=".",c.COMMA=",",c.CURLY_BRACKETS_LEFT="{",c.CURLY_BRACKETS_RIGHT="}",c.MINUS="-",c.OR="||",c.HASH="#",c.EMPTY_STRING="",c.SYMBOL_STAR="*",c.SYMBOL_QUESTION="?",c.SLASH="/",c.WHITE_SPACE=" ",c.NUMBER_ZERO="0",c.NUMBER_NINE="9",c.BACKSPACE="Backspace",c.DELETE="Delete",c.ARROW_LEFT="ArrowLeft",c.ARROW_UP="ArrowUp",c.DOUBLE_ZERO="00",c})(i||{}),L=new Z("ngx-mask config"),pe=new Z("new ngx-mask config"),de=new Z("initial ngx-mask config"),Te={suffix:"",prefix:"",thousandSeparator:" ",decimalMarker:[".",","],clearIfNotMatch:!1,showMaskTyped:!1,instantPrefix:!1,placeHolderCharacter:"_",dropSpecialCharacters:!0,hiddenInput:!1,shownMaskExpression:"",separatorLimit:"",allowNegativeNumbers:!1,validation:!0,specialCharacters:["-","/","(",")",".",":"," ","+",",","@","[","]",'"',"'"],leadZeroDateTime:!1,apm:!1,leadZero:!1,keepCharacterPositions:!1,triggerOnMaskChange:!1,inputTransformFn:c=>c,outputTransformFn:c=>c,maskFilled:new ie,patterns:{0:{pattern:new RegExp("\\d")},9:{pattern:new RegExp("\\d"),optional:!0},X:{pattern:new RegExp("\\d"),symbol:"*"},A:{pattern:new RegExp("[a-zA-Z0-9]")},S:{pattern:new RegExp("[a-zA-Z]")},U:{pattern:new RegExp("[A-Z]")},L:{pattern:new RegExp("[a-z]")},d:{pattern:new RegExp("\\d")},m:{pattern:new RegExp("\\d")},M:{pattern:new RegExp("\\d")},H:{pattern:new RegExp("\\d")},h:{pattern:new RegExp("\\d")},s:{pattern:new RegExp("\\d")}}},Ce=[i.HOURS_MINUTES_SECONDS,i.HOURS_MINUTES,i.MINUTES_SECONDS],Ne=[i.PERCENT,i.HOURS_HOUR,i.SECONDS,i.MINUTES,i.SEPARATOR,i.DAYS_MONTHS_YEARS,i.DAYS_MONTHS,i.DAYS,i.MONTHS],Ee=(()=>{class c{_config=T(L);dropSpecialCharacters=this._config.dropSpecialCharacters;hiddenInput=this._config.hiddenInput;clearIfNotMatch=this._config.clearIfNotMatch;specialCharacters=this._config.specialCharacters;patterns=this._config.patterns;prefix=this._config.prefix;suffix=this._config.suffix;thousandSeparator=this._config.thousandSeparator;decimalMarker=this._config.decimalMarker;customPattern;showMaskTyped=this._config.showMaskTyped;placeHolderCharacter=this._config.placeHolderCharacter;validation=this._config.validation;separatorLimit=this._config.separatorLimit;allowNegativeNumbers=this._config.allowNegativeNumbers;leadZeroDateTime=this._config.leadZeroDateTime;leadZero=this._config.leadZero;apm=this._config.apm;inputTransformFn=this._config.inputTransformFn;outputTransformFn=this._config.outputTransformFn;keepCharacterPositions=this._config.keepCharacterPositions;instantPrefix=this._config.instantPrefix;triggerOnMaskChange=this._config.triggerOnMaskChange;_shift=new Set;plusOnePosition=!1;maskExpression="";actualValue="";showKeepCharacterExp="";shownMaskExpression=this._config.shownMaskExpression;deletedSpecialCharacter=!1;ipError;cpfCnpjError;applyMask(t,e,r=0,s=!1,l=!1,u=()=>{}){if(!e||typeof t!="string")return i.EMPTY_STRING;let a=0,h="",m=!1,p=!1,_=1,M=!1,n=t,o=r,I=n.slice(0,this.prefix.length)===this.prefix,P=s&&n.length===this.prefix.length+e.length,x=n===this.prefix+n.slice(this.prefix.length);I&&(P||x)&&(n=n.slice(this.prefix.length)),this.suffix&&n.length>0&&(n=this.checkAndRemoveSuffix(n)),n==="("&&this.prefix&&(n="");let C=n.toString().split(i.EMPTY_STRING);if(this.allowNegativeNumbers&&n.slice(a,a+1)===i.MINUS&&(h+=n.slice(a,a+1)),e===i.IP){let S=n.split(i.DOT);this.ipError=this._validIP(S),e="099.099.099.099"}let y=[];for(let S=0;S<n.length;S++)n[S]?.match("\\d")&&y.push(n[S]??i.EMPTY_STRING);if(e===i.CPF_CNPJ&&(this.cpfCnpjError=y.length!==11&&y.length!==14,y.length>11?e="00.000.000/0000-00":e="000.000.000-00"),e.startsWith(i.PERCENT)){if(n.match("[a-z]|[A-Z]")||n.match(/[-!$%^&*()_+|~=`{}\[\]:";'<>?,\/.]/)&&!l){n=this._stripToDecimal(n);let N=this.getPrecision(e);n=this.checkInputPrecision(n,N,this.decimalMarker)}let S=typeof this.decimalMarker=="string"?this.decimalMarker:i.DOT;if(n.indexOf(S)>0&&!this.percentage(n.substring(0,n.indexOf(S)))){let N=n.substring(0,n.indexOf(S)-1);this.allowNegativeNumbers&&n.slice(a,a+1)===i.MINUS&&!l&&(N=n.substring(0,n.indexOf(S))),n=`${N}${n.substring(n.indexOf(S),n.length)}`}let f="";this.allowNegativeNumbers&&n.slice(a,a+1)===i.MINUS?f=`${i.MINUS}${n.slice(a+1,a+n.length)}`:f=n,this.percentage(f)?h=this._splitPercentZero(n):h=this._splitPercentZero(n.substring(0,n.length-1))}else if(e.startsWith(i.SEPARATOR)){(n.match("[w\u0430-\u044F\u0410-\u042F]")||n.match("[\u0401\u0451\u0410-\u044F]")||n.match("[a-z]|[A-Z]")||n.match(/[-@#!$%\\^&*()_£¬'+|~=`{}\]:";<>.?/]/)||n.match("[^A-Za-z0-9,]"))&&(n=this._stripToDecimal(n));let S=this.getPrecision(e),f=this.decimalMarker;if(Array.isArray(this.decimalMarker)&&(this.actualValue.includes(this.decimalMarker[0])||this.actualValue.includes(this.decimalMarker[1])?f=this.actualValue.includes(this.decimalMarker[0])?this.decimalMarker[0]:this.decimalMarker[1]:f=this.decimalMarker.find(g=>g!==this.thousandSeparator)),l){let{decimalMarkerIndex:g,nonZeroIndex:k}=this._findFirstNonZeroAndDecimalIndex(n,f),O=n[0]===i.MINUS,G=n[0]===i.NUMBER_ZERO,B=n[0]===f,H=n[1]===f;(B&&!k||O&&H&&!k||G&&!g&&!k)&&(n=i.NUMBER_ZERO),g&&k&&O&&o===1&&(g<k||g>k)&&(n=i.MINUS+n.slice(k)),!g&&k&&n.length>k&&(n=O?i.MINUS+n.slice(k):n.slice(k)),g&&k&&o===0&&(g<k&&(n=n.slice(g-1)),g>k&&(n=n.slice(k)))}S===0?n=this.allowNegativeNumbers?n.length>2&&n[0]===i.MINUS&&n[1]===i.NUMBER_ZERO&&n[2]!==this.thousandSeparator&&n[2]!==i.COMMA&&n[2]!==i.DOT?"-"+n.slice(2,n.length):n[0]===i.NUMBER_ZERO&&n.length>1&&n[1]!==this.thousandSeparator&&n[1]!==i.COMMA&&n[1]!==i.DOT?n.slice(1,n.length):n:n.length>1&&n[0]===i.NUMBER_ZERO&&n[1]!==this.thousandSeparator&&n[1]!==i.COMMA&&n[1]!==i.DOT?n.slice(1,n.length):n:(n[0]===f&&n.length>1&&!l&&(n=i.NUMBER_ZERO+n.slice(0,n.length+1),this.plusOnePosition=!0),n[0]===i.NUMBER_ZERO&&n[1]!==f&&n[1]!==this.thousandSeparator&&!l&&(n=n.length>1?n.slice(0,1)+f+n.slice(1,n.length+1):n,this.plusOnePosition=!0),this.allowNegativeNumbers&&!l&&n[0]===i.MINUS&&(n[1]===f||n[1]===i.NUMBER_ZERO)&&(n=n[1]===f&&n.length>2?n.slice(0,1)+i.NUMBER_ZERO+n.slice(1,n.length):n[1]===i.NUMBER_ZERO&&n.length>2&&n[2]!==f?n.slice(0,2)+f+n.slice(2,n.length):n,this.plusOnePosition=!0));let N=this._charToRegExpExpression(this.thousandSeparator),v='@#!$%^&*()_+|~=`{}\\[\\]:\\s,\\.";<>?\\/'.replace(N,"");if(Array.isArray(this.decimalMarker))for(let g of this.decimalMarker)v=v.replace(this._charToRegExpExpression(g),i.EMPTY_STRING);else v=v.replace(this._charToRegExpExpression(this.decimalMarker),"");let V=new RegExp("["+v+"]");n.match(V)&&(n=n.substring(0,n.length-1)),n=this.checkInputPrecision(n,S,this.decimalMarker);let b=n.replace(new RegExp(N,"g"),"");h=this._formatWithSeparators(b,this.thousandSeparator,this.decimalMarker,S);let z=h.indexOf(i.COMMA)-n.indexOf(i.COMMA),E=h.length-n.length,U=l&&h.length<t.length-this.suffix.length&&this.separatorLimit;if((h[o-1]===this.thousandSeparator||h[o-this.prefix.length])&&this.prefix&&l)o=o-1;else if(E>0&&h[o]!==this.thousandSeparator||U){p=!0;let g=0;do this._shift.add(o+g),g++;while(g<E)}else h[o-1]===this.thousandSeparator||E===-4||E===-3||h[o]===this.thousandSeparator?(this._shift.clear(),this._shift.add(o-1)):z!==0&&o>0&&!(h.indexOf(i.COMMA)>=o&&o>3)||!(h.indexOf(i.DOT)>=o&&o>3)&&E<=0?(this._shift.clear(),p=!0,_=E,o+=E,this._shift.add(o)):this._shift.clear()}else for(let S=0,f=C[0];S<C.length&&a!==e.length;S++,f=C[S]??i.EMPTY_STRING){let N=i.SYMBOL_STAR in this.patterns;if(this._checkSymbolMask(f,e[a]??i.EMPTY_STRING)&&e[a+1]===i.SYMBOL_QUESTION)h+=f,a+=2;else if(e[a+1]===i.SYMBOL_STAR&&m&&this._checkSymbolMask(f,e[a+2]??i.EMPTY_STRING))h+=f,a+=3,m=!1;else if(this._checkSymbolMask(f,e[a]??i.EMPTY_STRING)&&e[a+1]===i.SYMBOL_STAR&&!N)h+=f,m=!0;else if(e[a+1]===i.SYMBOL_QUESTION&&this._checkSymbolMask(f,e[a+2]??i.EMPTY_STRING))h+=f,a+=3;else if(this._checkSymbolMask(f,e[a]??i.EMPTY_STRING)){if(e[a]===i.HOURS&&(this.apm?Number(f)>9:Number(f)>2)){o=this.leadZeroDateTime?o:o+1,a+=1,this._shiftStep(a),S--,this.leadZeroDateTime&&(h+="0");continue}if(e[a]===i.HOUR&&(this.apm?h.length===1&&Number(h)>1||h==="1"&&Number(f)>2||n.slice(a-1,a).length===1&&Number(n.slice(a-1,a))>2||n.slice(a-1,a)==="1"&&Number(f)>2:h==="2"&&Number(f)>3||(h.slice(a-2,a)==="2"||h.slice(a-3,a)==="2"||h.slice(a-4,a)==="2"||h.slice(a-1,a)==="2")&&Number(f)>3&&a>10)){o=o+1,a+=1,S--;continue}if((e[a]===i.MINUTE||e[a]===i.SECOND)&&Number(f)>5){o=this.leadZeroDateTime?o:o+1,a+=1,this._shiftStep(a),S--,this.leadZeroDateTime&&(h+="0");continue}let v=31,V=n[a],b=n[a+1],z=n[a+2],E=n[a-1],U=n[a-2],g=n.slice(a-3,a-1),k=n.slice(a-1,a+1),O=n.slice(a,a+2),G=n.slice(a-2,a);if(e[a]===i.DAY){let B=e.slice(0,2)===i.MONTHS,H=e.slice(0,2)===i.MONTHS&&this.specialCharacters.includes(U);if(Number(f)>3&&this.leadZeroDateTime||!B&&(Number(O)>v||Number(k)>v||this.specialCharacters.includes(b))||(H?Number(k)>v||!this.specialCharacters.includes(V)&&this.specialCharacters.includes(z)||this.specialCharacters.includes(V):Number(O)>v||this.specialCharacters.includes(b)&&!l)){o=this.leadZeroDateTime?o:o+1,a+=1,this._shiftStep(a),S--,this.leadZeroDateTime&&(h+="0");continue}}if(e[a]===i.MONTH){let H=a===0&&(Number(f)>2||Number(O)>12||this.specialCharacters.includes(b)&&!l),Se=e.slice(a+2,a+3),_e=g.includes(Se)&&e.includes("d0")&&(this.specialCharacters.includes(U)&&Number(k)>12&&!this.specialCharacters.includes(V)||this.specialCharacters.includes(V)),ge=Number(g)<=v&&!this.specialCharacters.includes(g)&&this.specialCharacters.includes(E)&&(Number(O)>12||this.specialCharacters.includes(b)),ke=Number(O)>12&&a===5||this.specialCharacters.includes(b)&&a===5,Me=Number(g)>v&&!this.specialCharacters.includes(g)&&!this.specialCharacters.includes(G)&&Number(G)>12&&e.includes("d0"),ve=Number(g)<=v&&!this.specialCharacters.includes(g)&&!this.specialCharacters.includes(E)&&Number(k)>12;if(Number(f)>1&&this.leadZeroDateTime||H||_e||ve||Me||ge||ke&&!this.leadZeroDateTime){o=this.leadZeroDateTime?o:o+1,a+=1,this._shiftStep(a),S--,this.leadZeroDateTime&&(h+="0");continue}}h+=f,a++}else if(this.specialCharacters.includes(f)&&e[a]===f)h+=f,a++;else if(this.specialCharacters.indexOf(e[a]??i.EMPTY_STRING)!==-1)h+=e[a],a++,this._shiftStep(a),S--;else if(e[a]===i.NUMBER_NINE&&this.showMaskTyped)this._shiftStep(a);else if(this.patterns[e[a]??i.EMPTY_STRING]&&this.patterns[e[a]??i.EMPTY_STRING]?.optional){if(f.trim()===i.EMPTY_STRING)continue;C[a]&&e!=="099.099.099.099"&&e!=="000.000.000-00"&&e!=="00.000.000/0000-00"&&!e.match(/^9+\.0+$/)&&!this.patterns[e[a]??i.EMPTY_STRING]?.optional&&(h+=C[a]),e.includes(i.NUMBER_NINE+i.SYMBOL_STAR)&&e.includes(i.NUMBER_ZERO+i.SYMBOL_STAR)&&a++,a++,S--}else this.maskExpression[a+1]===i.SYMBOL_STAR&&this._findSpecialChar(this.maskExpression[a+2]??i.EMPTY_STRING)&&this._findSpecialChar(f)===this.maskExpression[a+2]&&m||this.maskExpression[a+1]===i.SYMBOL_QUESTION&&this._findSpecialChar(this.maskExpression[a+2]??i.EMPTY_STRING)&&this._findSpecialChar(f)===this.maskExpression[a+2]&&m?(a+=3,h+=f):this.showMaskTyped&&this.specialCharacters.indexOf(f)<0&&f!==this.placeHolderCharacter&&this.placeHolderCharacter.length===1&&(M=!0)}h[o-1]&&h.length+1===e.length&&this.specialCharacters.indexOf(e[e.length-1]??i.EMPTY_STRING)!==-1&&(h+=e[e.length-1]);let $=o+1;for(;this._shift.has($);)_++,$++;let D=s&&!e.startsWith(i.SEPARATOR)?a:this._shift.has(o)?_:0;M&&D--,u(D,p),_<0&&this._shift.clear();let Y=!1;l&&(Y=C.every(S=>this.specialCharacters.includes(S)));let w=`${this.prefix}${Y?i.EMPTY_STRING:h}${this.showMaskTyped?"":this.suffix}`;h.length===0&&(w=this.instantPrefix?`${this.prefix}${h}`:`${h}`);let F=n.length===1&&this.specialCharacters.includes(e[0])&&n!==e[0];if(!this._checkSymbolMask(n,e[1])&&F)return"";if(h.includes(i.MINUS)&&this.prefix&&this.allowNegativeNumbers){if(l&&h===i.MINUS)return"";w=`${i.MINUS}${this.prefix}${h.split(i.MINUS).join(i.EMPTY_STRING)}${this.suffix}`}return w}_findDropSpecialChar(t){return Array.isArray(this.dropSpecialCharacters)?this.dropSpecialCharacters.find(e=>e===t):this._findSpecialChar(t)}_findSpecialChar(t){return this.specialCharacters.find(e=>e===t)}_checkSymbolMask(t,e){return this.patterns=this.customPattern?this.customPattern:this.patterns,(this.patterns[e]?.pattern&&this.patterns[e]?.pattern.test(t))??!1}_formatWithSeparators=(t,e,r,s)=>{let l=[],u="";if(Array.isArray(r)){let _=new RegExp(r.map(M=>"[\\^$.|?*+()".indexOf(M)>=0?`\\${M}`:M).join("|"));l=t.split(_),u=t.match(_)?.[0]??i.EMPTY_STRING}else l=t.split(r),u=r;let a=l.length>1?`${u}${l[1]}`:i.EMPTY_STRING,h=l[0]??i.EMPTY_STRING,m=this.separatorLimit.replace(/\s/g,i.EMPTY_STRING);m&&+m&&(h[0]===i.MINUS?h=`-${h.slice(1,h.length).slice(0,m.length)}`:h=h.slice(0,m.length));let p=/(\d+)(\d{3})/;for(;e&&p.test(h);)h=h.replace(p,"$1"+e+"$2");return typeof s>"u"?h+a:s===0?h:h+a.substring(0,s+1)};percentage=t=>{let e=t.replace(",","."),r=Number(this.allowNegativeNumbers&&t.includes(i.MINUS)?e.slice(1,t.length):e);return!isNaN(r)&&r>=0&&r<=100};getPrecision=t=>{let e=t.split(i.DOT);return e.length>1?Number(e[e.length-1]):1/0};checkAndRemoveSuffix=t=>{for(let e=this.suffix?.length-1;e>=0;e--){let r=this.suffix.substring(e,this.suffix?.length);if(t.includes(r)&&e!==this.suffix?.length-1&&(e-1<0||!t.includes(this.suffix.substring(e-1,this.suffix?.length))))return t.replace(r,i.EMPTY_STRING)}return t};checkInputPrecision=(t,e,r)=>{let s=t,l=r;if(e<1/0){if(Array.isArray(l)){let m=l.find(p=>p!==this.thousandSeparator);l=m||l[0]}let u=new RegExp(this._charToRegExpExpression(l)+`\\d{${e}}.*$`),a=s.match(u),h=(a&&a[0]?.length)??0;if(h-1>e){let m=h-1-e;s=s.substring(0,s.length-m)}e===0&&this._compareOrIncludes(s[s.length-1],l,this.thousandSeparator)&&(s=s.substring(0,s.length-1))}return s};_stripToDecimal(t){return t.split(i.EMPTY_STRING).filter((e,r)=>{let s=typeof this.decimalMarker=="string"?e===this.decimalMarker:this.decimalMarker.includes(e);return e.match("^-?\\d")||e===this.thousandSeparator||s||e===i.MINUS&&r===0&&this.allowNegativeNumbers}).join(i.EMPTY_STRING)}_charToRegExpExpression(t){return t&&(t===" "?"\\s":"[\\^$.|?*+()".indexOf(t)>=0?`\\${t}`:t)}_shiftStep(t){this._shift.add(t+this.prefix.length||0)}_compareOrIncludes(t,e,r){return Array.isArray(e)?e.filter(s=>s!==r).includes(t):t===e}_validIP(t){return!(t.length===4&&!t.some((e,r)=>t.length!==r+1?e===i.EMPTY_STRING||Number(e)>255:e===i.EMPTY_STRING||Number(e.substring(0,3))>255))}_splitPercentZero(t){if(t===i.MINUS&&this.allowNegativeNumbers)return t;let e=typeof this.decimalMarker=="string"?t.indexOf(this.decimalMarker):t.indexOf(i.DOT),r=this.allowNegativeNumbers&&t.includes(i.MINUS)?"-":"";if(e===-1){let s=parseInt(r?t.slice(1,t.length):t,10);return isNaN(s)?i.EMPTY_STRING:`${r}${s}`}else{let s=parseInt(t.replace("-","").substring(0,e),10),l=t.substring(e+1),u=isNaN(s)?"":s.toString(),a=typeof this.decimalMarker=="string"?this.decimalMarker:i.DOT;return u===i.EMPTY_STRING?i.EMPTY_STRING:`${r}${u}${a}${l}`}}_findFirstNonZeroAndDecimalIndex(t,e){let r=null,s=null;for(let l=0;l<t.length;l++){let u=t[l];if(u===e&&r===null&&(r=l),u&&u>="1"&&u<="9"&&s===null&&(s=l),r!==null&&s!==null)break}return{decimalMarkerIndex:r,nonZeroIndex:s}}static \u0275fac=function(e){return new(e||c)};static \u0275prov=q({token:c,factory:c.\u0275fac})}return c})(),K=(()=>{class c extends Ee{isNumberValue=!1;maskIsShown="";selStart=null;selEnd=null;maskChanged=!1;maskExpressionArray=[];previousValue="";currentValue="";writingValue=!1;isInitialized=!1;_emitValue=!1;_start;_end;onChange=t=>{};_elementRef=T(ae,{optional:!0});document=T(Q);_config=T(L);_renderer=T(ne,{optional:!0});applyMask(t,e,r=0,s=!1,l=!1,u=()=>{}){if(!e)return t!==this.actualValue?this.actualValue:t;if(this.maskIsShown=this.showMaskTyped?this.showMaskInInput():i.EMPTY_STRING,this.maskExpression===i.IP&&this.showMaskTyped&&(this.maskIsShown=this.showMaskInInput(t||i.HASH)),this.maskExpression===i.CPF_CNPJ&&this.showMaskTyped&&(this.maskIsShown=this.showMaskInInput(t||i.HASH)),!t&&this.showMaskTyped)return this.formControlResult(this.prefix),`${this.prefix}${this.maskIsShown}${this.suffix}`;let a=t&&typeof this.selStart=="number"?t[this.selStart]??i.EMPTY_STRING:i.EMPTY_STRING,h="",m=r;if((this.hiddenInput||t&&t.indexOf(i.SYMBOL_STAR)>=0)&&!this.writingValue){let o=t&&t.length===1?t.split(i.EMPTY_STRING):this.actualValue.split(i.EMPTY_STRING);l&&(o=o.slice(0,r).concat(o.slice(r+1))),this.showMaskTyped&&(t=this.removeMask(t),o=this.removeMask(o.join("")).split(i.EMPTY_STRING)),typeof this.selStart=="object"&&typeof this.selEnd=="object"?(this.selStart=Number(this.selStart),this.selEnd=Number(this.selEnd)):t!==i.EMPTY_STRING&&o.length?typeof this.selStart=="number"&&typeof this.selEnd=="number"&&(t.length>o.length?o.splice(this.selStart,0,a):t.length<o.length&&(o.length-t.length===1?l?o.splice(this.selStart-1,1):o.splice(t.length-1,1):o.splice(this.selStart,this.selEnd-this.selStart))):o=[],this.showMaskTyped&&!this.hiddenInput&&(h=this.removeMask(t)),this.actualValue.length?o.length<t.length?h=this.shiftTypedSymbols(o.join(i.EMPTY_STRING)):o.length===t.length?h=o.join(i.EMPTY_STRING):h=t:h=t}if(s&&(this.hiddenInput||!this.hiddenInput)&&(h=t),l&&this.specialCharacters.indexOf(this.maskExpression[m]??i.EMPTY_STRING)!==-1&&this.showMaskTyped&&!this.prefix&&(h=this.currentValue),this.deletedSpecialCharacter&&m&&(this.specialCharacters.includes(this.actualValue.slice(m,m+1))?m=m+1:e.slice(m-1,m+1)!==i.MONTHS&&(m=m-2),this.deletedSpecialCharacter=!1),this.showMaskTyped&&this.placeHolderCharacter.length===1&&!this.leadZeroDateTime&&(h=this.removeMask(h)),this.maskChanged?h=t:h=h&&h.length?h:t,this.showMaskTyped&&this.keepCharacterPositions&&this.actualValue&&!s&&!this.writingValue){let o=this.dropSpecialCharacters?this.removeMask(this.actualValue):this.actualValue;return this.formControlResult(o),this.actualValue?this.actualValue:`${this.prefix}${this.maskIsShown}${this.suffix}`}let p=super.applyMask(h,e,m,s,l,u);if(this.actualValue=this.getActualValue(p),this.thousandSeparator===i.DOT&&this.decimalMarker===i.DOT&&(this.decimalMarker=i.COMMA),this.maskExpression.startsWith(i.SEPARATOR)&&this.dropSpecialCharacters===!0&&(this.specialCharacters=this.specialCharacters.filter(o=>!this._compareOrIncludes(o,this.decimalMarker,this.thousandSeparator))),(p||p==="")&&(this.previousValue=this.currentValue,this.currentValue=p,this._emitValue=this.previousValue!==this.currentValue||this.previousValue===this.currentValue&&s),this._emitValue&&(!this.maskChanged||this.triggerOnMaskChange)&&this.formControlResult(p),this.maskChanged&&!this.triggerOnMaskChange&&(this.maskChanged=!1),!this.showMaskTyped||this.showMaskTyped&&this.hiddenInput)return this.hiddenInput?`${this.hideInput(p,this.maskExpression)}${this.maskIsShown.slice(p.length)}`:p;let M=p.length,n=`${this.prefix}${this.maskIsShown}${this.suffix}`;if(this.maskExpression.includes(i.HOURS)){let o=this._numberSkipedSymbols(p);return`${p}${n.slice(M+o)}`}else if(this.maskExpression===i.IP||this.maskExpression===i.CPF_CNPJ)return`${p}${n}`;return`${p}${n.slice(M)}`}_numberSkipedSymbols(t){let e=/(^|\D)(\d\D)/g,r=e.exec(t),s=0;for(;r!=null;)s+=1,r=e.exec(t);return s}applyValueChanges(t,e,r,s=()=>{}){let l=this._elementRef?.nativeElement;l&&(l.value=this.applyMask(l.value,this.maskExpression,t,e,r,s),l!==this._getActiveElement()&&this.clearIfNotMatchFn())}hideInput(t,e){return t.split(i.EMPTY_STRING).map((r,s)=>this.patterns&&this.patterns[e[s]??i.EMPTY_STRING]&&this.patterns[e[s]??i.EMPTY_STRING]?.symbol?this.patterns[e[s]??i.EMPTY_STRING]?.symbol:r).join(i.EMPTY_STRING)}getActualValue(t){let e=t.split(i.EMPTY_STRING).filter((r,s)=>{let l=this.maskExpression[s]??i.EMPTY_STRING;return this._checkSymbolMask(r,l)||this.specialCharacters.includes(l)&&r===l});return e.join(i.EMPTY_STRING)===t?e.join(i.EMPTY_STRING):t}shiftTypedSymbols(t){let e="";return(t&&t.split(i.EMPTY_STRING).map((s,l)=>{if(this.specialCharacters.includes(t[l+1]??i.EMPTY_STRING)&&t[l+1]!==this.maskExpression[l+1])return e=s,t[l+1];if(e.length){let u=e;return e=i.EMPTY_STRING,u}return s})||[]).join(i.EMPTY_STRING)}numberToString(t){return!t&&t!==0||this.maskExpression.startsWith(i.SEPARATOR)&&(this.leadZero||!this.dropSpecialCharacters)||this.maskExpression.startsWith(i.SEPARATOR)&&this.separatorLimit.length>14&&String(t).length>14?String(t):Number(t).toLocaleString("fullwide",{useGrouping:!1,maximumFractionDigits:20}).replace(`/${i.MINUS}/`,i.MINUS)}showMaskInInput(t){if(this.showMaskTyped&&this.shownMaskExpression){if(this.maskExpression.length!==this.shownMaskExpression.length)throw new Error("Mask expression must match mask placeholder length");return this.shownMaskExpression}else if(this.showMaskTyped){if(t){if(this.maskExpression===i.IP)return this._checkForIp(t);if(this.maskExpression===i.CPF_CNPJ)return this._checkForCpfCnpj(t)}return this.placeHolderCharacter.length===this.maskExpression.length?this.placeHolderCharacter:this.maskExpression.replace(/\w/g,this.placeHolderCharacter)}return""}clearIfNotMatchFn(){let t=this._elementRef?.nativeElement;t&&this.clearIfNotMatch&&this.prefix.length+this.maskExpression.length+this.suffix.length!==t.value.replace(this.placeHolderCharacter,i.EMPTY_STRING).length&&(this.formElementProperty=["value",i.EMPTY_STRING],this.applyMask("",this.maskExpression))}set formElementProperty([t,e]){!this._renderer||!this._elementRef||queueMicrotask(()=>{this._renderer?.setProperty(this._elementRef?.nativeElement,t,e)})}checkDropSpecialCharAmount(t){return t.split(i.EMPTY_STRING).filter(r=>this._findDropSpecialChar(r)).length}removeMask(t){return this._removeMask(this._removeSuffix(this._removePrefix(t)),this.specialCharacters.concat("_").concat(this.placeHolderCharacter))}_checkForIp(t){if(t===i.HASH)return`${this.placeHolderCharacter}.${this.placeHolderCharacter}.${this.placeHolderCharacter}.${this.placeHolderCharacter}`;let e=[];for(let r=0;r<t.length;r++){let s=t[r]??i.EMPTY_STRING;s&&s.match("\\d")&&e.push(s)}return e.length<=3?`${this.placeHolderCharacter}.${this.placeHolderCharacter}.${this.placeHolderCharacter}`:e.length>3&&e.length<=6?`${this.placeHolderCharacter}.${this.placeHolderCharacter}`:e.length>6&&e.length<=9?this.placeHolderCharacter:(e.length>9&&e.length<=12,"")}_checkForCpfCnpj(t){let e=`${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}-${this.placeHolderCharacter}${this.placeHolderCharacter}`,r=`${this.placeHolderCharacter}${this.placeHolderCharacter}.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}.${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}/${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}${this.placeHolderCharacter}-${this.placeHolderCharacter}${this.placeHolderCharacter}`;if(t===i.HASH)return e;let s=[];for(let l=0;l<t.length;l++){let u=t[l]??i.EMPTY_STRING;u&&u.match("\\d")&&s.push(u)}return s.length<=3?e.slice(s.length,e.length):s.length>3&&s.length<=6?e.slice(s.length+1,e.length):s.length>6&&s.length<=9?e.slice(s.length+2,e.length):s.length>9&&s.length<11?e.slice(s.length+3,e.length):s.length===11?"":s.length===12?t.length===17?r.slice(16,r.length):r.slice(15,r.length):s.length>12&&s.length<=14?r.slice(s.length+4,r.length):""}_getActiveElement(t=this.document){let e=t?.activeElement?.shadowRoot;return e?.activeElement?this._getActiveElement(e):t.activeElement}formControlResult(t){let e=this.outputTransformFn?this.outputTransformFn:r=>r;this.writingValue=!1,this.maskChanged=!1,!(!this.isInitialized&&this._emitValue)&&(Array.isArray(this.dropSpecialCharacters)?this.onChange(e(this._toNumber(this._checkSymbols(this._removeMask(this._removeSuffix(this._removePrefix(t)),this.dropSpecialCharacters))))):this.dropSpecialCharacters||!this.dropSpecialCharacters&&this.prefix===t?this.onChange(e(this._toNumber(this._checkSymbols(this._removeSuffix(this._removePrefix(t)))))):this.onChange(e(this._toNumber(t))))}_toNumber(t){if(!this.isNumberValue||t===i.EMPTY_STRING||this.maskExpression.startsWith(i.SEPARATOR)&&(this.leadZero||!this.dropSpecialCharacters))return t;if(String(t).length>14&&this.maskExpression.startsWith(i.SEPARATOR))return String(t);let e=Number(t);if(this.maskExpression.startsWith(i.SEPARATOR)&&Number.isNaN(e)){let r=String(t).replace(",",".");return Number(r)}return Number.isNaN(e)?t:e}_removeMask(t,e){return this.maskExpression.startsWith(i.PERCENT)&&t.includes(i.DOT)?t:t&&t.replace(this._regExpForRemove(e),i.EMPTY_STRING)}_removePrefix(t){return this.prefix?t&&t.replace(this.prefix,i.EMPTY_STRING):t}_removeSuffix(t){return this.suffix?t&&t.replace(this.suffix,i.EMPTY_STRING):t}_retrieveSeparatorValue(t){let e=Array.isArray(this.dropSpecialCharacters)?this.specialCharacters.filter(r=>this.dropSpecialCharacters.includes(r)):this.specialCharacters;return!this.deletedSpecialCharacter&&this._checkPatternForSpace()&&t.includes(i.WHITE_SPACE)&&this.maskExpression.includes(i.SYMBOL_STAR)&&(e=e.filter(r=>r!==i.WHITE_SPACE)),this._removeMask(t,e)}_regExpForRemove(t){return new RegExp(t.map(e=>/[.*+?^${}()|[\]\\/-]/.test(e)?`\\${e}`:e).join("|"),"gi")}_replaceDecimalMarkerToDot(t){let e=Array.isArray(this.decimalMarker)?this.decimalMarker:[this.decimalMarker];return t.replace(this._regExpForRemove(e),i.DOT)}_checkSymbols(t){let e=t;if(e===i.EMPTY_STRING)return e;this.maskExpression.startsWith(i.PERCENT)&&this.decimalMarker===i.COMMA&&(e=e.replace(i.COMMA,i.DOT));let r=this._retrieveSeparatorPrecision(this.maskExpression),s=this.specialCharacters.length===0?this._retrieveSeparatorValue(e):this._replaceDecimalMarkerToDot(this._retrieveSeparatorValue(e));return this.isNumberValue&&r?e===this.decimalMarker?null:s.length>14?String(s):this._checkPrecision(this.maskExpression,s):s}_checkPatternForSpace(){for(let t in this.patterns)if(this.patterns[t]&&this.patterns[t]?.hasOwnProperty("pattern")){let e=this.patterns[t]?.pattern.toString(),r=this.patterns[t]?.pattern;if(e?.includes(i.WHITE_SPACE)&&r?.test(this.maskExpression))return!0}return!1}_retrieveSeparatorPrecision(t){let e=t.match(new RegExp("^separator\\.([^d]*)"));return e?Number(e[1]):null}_checkPrecision(t,e){let r=this.getPrecision(t),s=e;return t.indexOf("2")>0||this.leadZero&&Number(r)>0&&Number.isFinite(r)?(this.decimalMarker===i.COMMA&&this.leadZero&&(s=s.replace(",",".")),this.leadZero?Number(s).toFixed(Number(r)):Number(s).toFixed(2)):this.numberToString(s)}_repeatPatternSymbols(t){return t.match(/{[0-9]+}/)&&t.split(i.EMPTY_STRING).reduce((e,r,s)=>{if(this._start=r===i.CURLY_BRACKETS_LEFT?s:this._start,r!==i.CURLY_BRACKETS_RIGHT)return this._findSpecialChar(r)?e+r:e;this._end=s;let l=Number(t.slice(this._start+1,this._end)),u=new Array(l+1).join(t[this._start-1]);if(t.slice(0,this._start).length>1&&t.includes(i.LETTER_S)){let a=t.slice(0,this._start-1);return a.includes(i.CURLY_BRACKETS_LEFT)?e+u:a+e+u}else return e+u},"")||t}currentLocaleDecimalMarker(){return 1.1.toLocaleString().substring(1,2)}static \u0275fac=(()=>{let t;return function(r){return(t||(t=re(c)))(r||c)}})();static \u0275prov=q({token:c,factory:c.\u0275fac})}return c})();function Re(){let c=T(de),W=T(pe);return W instanceof Function?A(A({},c),W()):A(A({},c),W)}function Ve(c){return[{provide:pe,useValue:c},{provide:de,useValue:Te},{provide:L,useFactory:Re},K]}var $e=(()=>{class c{mask=d("");specialCharacters=d([]);patterns=d({});prefix=d("");suffix=d("");thousandSeparator=d(" ");decimalMarker=d(".");dropSpecialCharacters=d(null);hiddenInput=d(null);showMaskTyped=d(null);placeHolderCharacter=d(null);shownMaskExpression=d(null);clearIfNotMatch=d(null);validation=d(null);separatorLimit=d("");allowNegativeNumbers=d(null);leadZeroDateTime=d(null);leadZero=d(null);triggerOnMaskChange=d(null);apm=d(null);inputTransformFn=d(null);outputTransformFn=d(null);keepCharacterPositions=d(null);instantPrefix=d(null);value=X("");errors=d([]);disabled=d(!1);touched=X(!1);dirty=d(!1);invalid=d(!1);pending=d(!1);readonly=d(!1);required=d(!1);name=d("");maskFilled=ue();_maskValue=R("");_inputValue=R("");_position=R(null);_code=R("");_maskExpressionArray=R([]);_justPasted=R(!1);_isFocused=R(!1);_isComposing=R(!1);_isSignalFormsMode=R(!1);_maskService=T(K,{self:!0});document=T(Q);_config=T(L);onChange=t=>{};onTouch=()=>{};constructor(){J(()=>{let t=this.value();this._isSignalFormsMode()&&t!==j(()=>this._inputValue())&&j(()=>{this.writeValue(t)})}),J(()=>{let t=this.disabled();j(()=>{this.setDisabledState(t)})})}ngOnInit(){this.value()!==""&&this._isSignalFormsMode.set(!0)}ngOnChanges(t){let{mask:e,specialCharacters:r,patterns:s,prefix:l,suffix:u,thousandSeparator:a,decimalMarker:h,dropSpecialCharacters:m,hiddenInput:p,showMaskTyped:_,placeHolderCharacter:M,shownMaskExpression:n,clearIfNotMatch:o,validation:I,separatorLimit:P,allowNegativeNumbers:x,leadZeroDateTime:C,leadZero:y,triggerOnMaskChange:$,apm:D,inputTransformFn:Y,outputTransformFn:w,keepCharacterPositions:F,instantPrefix:S}=t;if(e&&(e.currentValue!==e.previousValue&&!e.firstChange&&(this._maskService.maskChanged=!0),e.currentValue&&e.currentValue.split(i.OR).length>1?(this._maskExpressionArray.set(e.currentValue.split(i.OR).sort((f,N)=>f.length-N.length)),this._setMask()):(this._maskExpressionArray.set([]),this._maskValue.set(e.currentValue||i.EMPTY_STRING),this._maskService.maskExpression=this._maskValue())),r){if(!r.currentValue||!Array.isArray(r.currentValue))return;this._maskService.specialCharacters=r.currentValue||[]}if(x&&(this._maskService.allowNegativeNumbers=x.currentValue,this._maskService.allowNegativeNumbers&&(this._maskService.specialCharacters=this._maskService.specialCharacters.filter(f=>f!==i.MINUS))),s&&s.currentValue&&(this._maskService.patterns=s.currentValue),D&&D.currentValue&&(this._maskService.apm=D.currentValue),S&&(this._maskService.instantPrefix=S.currentValue),l&&(this._maskService.prefix=l.currentValue),u&&(this._maskService.suffix=u.currentValue),a&&(this._maskService.thousandSeparator=a.currentValue,a.previousValue&&a.currentValue)){let f=this._maskService.decimalMarker;a.currentValue===this._maskService.decimalMarker&&(this._maskService.decimalMarker=a.currentValue===i.COMMA?i.DOT:i.COMMA),this._maskService.dropSpecialCharacters===!0&&(this._maskService.specialCharacters=this._config.specialCharacters),typeof f=="string"&&typeof this._maskService.decimalMarker=="string"&&(this._inputValue.set(this._inputValue().split(a.previousValue).join("").replace(f,this._maskService.decimalMarker)),this._maskService.actualValue=this._inputValue()),this._maskService.writingValue=!0}h&&(this._maskService.decimalMarker=h.currentValue),m&&(this._maskService.dropSpecialCharacters=m.currentValue),p&&(this._maskService.hiddenInput=p.currentValue,p.previousValue===!0&&p.currentValue===!1&&this._inputValue.set(this._maskService.actualValue)),_&&(this._maskService.showMaskTyped=_.currentValue,_.previousValue===!1&&_.currentValue===!0&&this._isFocused()&&requestAnimationFrame(()=>{this._maskService._elementRef?.nativeElement.click()})),M&&(this._maskService.placeHolderCharacter=M.currentValue),n&&(this._maskService.shownMaskExpression=n.currentValue),o&&(this._maskService.clearIfNotMatch=o.currentValue),I&&(this._maskService.validation=I.currentValue),P&&(this._maskService.separatorLimit=P.currentValue),C&&(this._maskService.leadZeroDateTime=C.currentValue),y&&(this._maskService.leadZero=y.currentValue),$&&(this._maskService.triggerOnMaskChange=$.currentValue),Y&&(this._maskService.inputTransformFn=Y.currentValue),w&&(this._maskService.outputTransformFn=w.currentValue),F&&(this._maskService.keepCharacterPositions=F.currentValue),this._applyMask()}validate({value:t}){let e=typeof t=="number"?String(t):t,r=this._maskValue();if(!this._maskService.validation||!r)return null;if(this._maskService.ipError)return this._createValidationError(e);if(this._maskService.cpfCnpjError)return this._createValidationError(e);if(r.startsWith(i.SEPARATOR)||Ne.includes(r)||this._maskService.clearIfNotMatch)return null;if(Ce.includes(r))return this._validateTime(e);if(r===i.EMAIL_MASK)return!/^[^@]+@[^@]+\.[^@]+$/.test(e)&&e?this._createValidationError(e):null;if(e&&e.length>=1){let s=0;if(r.includes(i.CURLY_BRACKETS_LEFT)&&r.includes(i.CURLY_BRACKETS_RIGHT))return r.slice(r.indexOf(i.CURLY_BRACKETS_LEFT)+1,r.indexOf(i.CURLY_BRACKETS_RIGHT))===String(e.length)?null:this._createValidationError(e);if(r.startsWith(i.PERCENT))return null;for(let l in this._maskService.patterns)if(this._maskService.patterns[l]?.optional){if(r.indexOf(l)!==r.lastIndexOf(l)){let u=r.split(i.EMPTY_STRING).filter(a=>a===l).join(i.EMPTY_STRING);s+=u.length}else r.indexOf(l)!==-1&&s++;if(r.indexOf(l)!==-1&&e.length>=r.indexOf(l)||s===r.length)return null}if(r.indexOf(i.SYMBOL_STAR)>1&&e.length<r.indexOf(i.SYMBOL_STAR)||r.indexOf(i.SYMBOL_QUESTION)>1&&e.length<r.indexOf(i.SYMBOL_QUESTION))return this._createValidationError(e);if(r.indexOf(i.SYMBOL_STAR)===-1||r.indexOf(i.SYMBOL_QUESTION)===-1){let l=r.split("*"),u=this._maskService.dropSpecialCharacters?r.length-this._maskService.checkDropSpecialCharAmount(r)-s:this.prefix()?r.length+this.prefix().length-s:r.length-s;if(l.length===1&&e.length<u)return this._createValidationError(e);if(l.length>1){let a=l[l.length-1];if(a&&this._maskService.specialCharacters.includes(a[0])&&String(e).includes(a[0]??"")&&!this.dropSpecialCharacters()){let h=t.split(a[0]);return h[h.length-1].length===a.length-1?null:this._createValidationError(e)}else return(a&&!this._maskService.specialCharacters.includes(a[0])||!a||this._maskService.dropSpecialCharacters)&&e.length>=u-1?null:this._createValidationError(e)}}if(r.indexOf(i.SYMBOL_STAR)===1||r.indexOf(i.SYMBOL_QUESTION)===1)return null}return t&&this.maskFilled.emit(),null}onPaste(){this._justPasted.set(!0)}onFocus(){this._isFocused.set(!0)}onModelChange(t){(t===i.EMPTY_STRING||t===null||typeof t>"u")&&this._maskService.actualValue&&(this._maskService.actualValue=this._maskService.getActualValue(i.EMPTY_STRING))}onInput(t){if(this._maskService.isInitialized=!0,this._isComposing())return;let e=t.target,r=this._maskService.inputTransformFn?this._maskService.inputTransformFn(e.value):e.value;if(e.type!=="number")if(typeof r=="string"||typeof r=="number"){if(e.value=r.toString(),this._inputValue.set(e.value),this._setMask(),!this._maskValue()){this.onChange(e.value);return}let s=e.selectionStart===1?e.selectionStart+this._maskService.prefix.length:e.selectionStart;if(this.showMaskTyped()&&this.keepCharacterPositions()&&this._maskService.placeHolderCharacter.length===1){let h=this.suffix(),m=this.prefix(),p=e.value.slice(s-1,s),_=m.length,M=this._maskService._checkSymbolMask(p,this._maskService.maskExpression[s-1-_]??i.EMPTY_STRING),n=this._maskService._checkSymbolMask(p,this._maskService.maskExpression[s+1-_]??i.EMPTY_STRING),o=this._maskService.selStart===this._maskService.selEnd,I=Number(this._maskService.selStart)-_,P=Number(this._maskService.selEnd)-_,x=this._code()===i.BACKSPACE||this._code()===i.DELETE;if(x){if(!o)this._maskService.selStart===_?this._maskService.actualValue=`${m}${this._maskService.maskIsShown.slice(0,P)}${this._inputValue().split(m).join("")}`:this._maskService.selStart===this._maskService.maskIsShown.length+_?this._maskService.actualValue=`${this._inputValue()}${this._maskService.maskIsShown.slice(I,P)}`:this._maskService.actualValue=`${m}${this._inputValue().split(m).join("").slice(0,I)}${this._maskService.maskIsShown.slice(I,P)}${this._maskService.actualValue.slice(P+_,this._maskService.maskIsShown.length+_)}${h}`;else if(!this._maskService.specialCharacters.includes(this._maskService.maskExpression.slice(s-_,s+1-_))&&o)if(I===1&&m)this._maskService.actualValue=`${m}${this._maskService.placeHolderCharacter}${e.value.split(m).join("").split(h).join("")}${h}`,s=s-1;else{let C=e.value.substring(0,s),y=e.value.substring(s);this._maskService.actualValue=`${C}${this._maskService.placeHolderCharacter}${y}`}s=this._code()===i.DELETE?s+1:s}x||(!M&&!n&&o?s=Number(e.selectionStart)-1:this._maskService.specialCharacters.includes(e.value.slice(s,s+1))&&n&&!this._maskService.specialCharacters.includes(e.value.slice(s+1,s+2))?(this._maskService.actualValue=`${e.value.slice(0,s-1)}${e.value.slice(s,s+1)}${p}${e.value.slice(s+2)}`,s=s+1):M?e.value.length===1&&s===1?this._maskService.actualValue=`${m}${p}${this._maskService.maskIsShown.slice(1,this._maskService.maskIsShown.length)}${h}`:this._maskService.actualValue=`${e.value.slice(0,s-1)}${p}${e.value.slice(s+1).split(h).join("")}${h}`:m&&e.value.length===1&&s-_===1&&this._maskService._checkSymbolMask(e.value,this._maskService.maskExpression[s-1-_]??i.EMPTY_STRING)&&(this._maskService.actualValue=`${m}${e.value}${this._maskService.maskIsShown.slice(1,this._maskService.maskIsShown.length)}${h}`))}let l=0,u=!1;if(this._code()===i.DELETE&&i.SEPARATOR&&(this._maskService.deletedSpecialCharacter=!0),this._inputValue().length>=this._maskService.maskExpression.length-1&&this._code()!==i.BACKSPACE&&this._maskService.maskExpression===i.DAYS_MONTHS_YEARS&&s<10){let h=this._inputValue().slice(s-1,s);e.value=this._inputValue().slice(0,s-1)+h+this._inputValue().slice(s+1)}if(this._maskService.maskExpression===i.DAYS_MONTHS_YEARS&&this.leadZeroDateTime()&&(s<3&&Number(e.value)>31&&Number(e.value)<40||s===5&&Number(e.value.slice(3,5))>12)&&(s=s+2),this._maskService.maskExpression===i.HOURS_MINUTES_SECONDS&&this.apm()&&(this._justPasted()&&e.value.slice(0,2)===i.DOUBLE_ZERO&&(e.value=e.value.slice(1,2)+e.value.slice(2,e.value.length)),e.value=e.value===i.DOUBLE_ZERO?i.NUMBER_ZERO:e.value),this._maskService.applyValueChanges(s,this._justPasted(),this._code()===i.BACKSPACE||this._code()===i.DELETE,(h,m)=>{this._justPasted.set(!1),l=h,u=m}),this._getActiveElement()!==e)return;if(this._maskService.plusOnePosition&&(s=s+1,this._maskService.plusOnePosition=!1),this._maskExpressionArray().length)if(this._code()===i.BACKSPACE){let h=this.specialCharacters().includes(this._maskService.actualValue.slice(s-1,s)),m=this._maskService.removeMask(this._inputValue())?.length===this._maskService.removeMask(this._maskService.maskExpression)?.length,p=this.specialCharacters().includes(this._maskService.actualValue.slice(s,s+1));m&&!p?s=e.selectionStart+1:s=h?s-1:s}else s=e.selectionStart===1?e.selectionStart+this._maskService.prefix.length:e.selectionStart;this._position.set(this._position()===1&&this._inputValue().length===1?null:this._position());let a=this._position()?this._inputValue().length+s+l:s+(this._code()===i.BACKSPACE&&!u?0:l);a>this._getActualInputLength()&&(a=e.value===this._maskService.decimalMarker&&e.value.length===1?this._getActualInputLength()+1:this._getActualInputLength()),a<0&&(a=0),e.setSelectionRange(a,a),this._position.set(null)}else console.warn("Ngx-mask writeValue work with string | number, your current value:",typeof r);else{if(!this._maskValue()){this.onChange(e.value);return}this._maskService.applyValueChanges(e.value.length,this._justPasted(),this._code()===i.BACKSPACE||this._code()===i.DELETE)}}onCompositionStart(){this._isComposing.set(!0)}onCompositionEnd(t){this._isComposing.set(!1),this._justPasted.set(!0),this.onInput(t)}onBlur(t){if(this._maskValue()){let e=t.target;if(this._maskService.leadZero&&e.value.length>0&&typeof this._maskService.decimalMarker=="string"){let r=this._maskService.maskExpression,s=this._maskService.decimalMarker,l=this._maskService.suffix,u=Number(this._maskService.maskExpression.slice(r.length-1,r.length));if(u>0){e.value=l?e.value.split(l).join(""):e.value;let a=e.value.split(s)[1];e.value=e.value.includes(s)?e.value+i.NUMBER_ZERO.repeat(u-a.length)+l:e.value+s+i.NUMBER_ZERO.repeat(u)+l,this._maskService.actualValue=e.value}}this._maskService.clearIfNotMatchFn()}this._isFocused.set(!1),this.onTouch()}onClick(t){if(!this._maskValue())return;let e=t.target,r=0,s=0;e!==null&&e.selectionStart!==null&&e.selectionStart===e.selectionEnd&&e.selectionStart>this._maskService.prefix.length&&t.keyCode!==38&&this._maskService.showMaskTyped&&!this.keepCharacterPositions()&&(this._maskService.maskIsShown=this._maskService.showMaskInInput(),e.setSelectionRange&&this._maskService.prefix+this._maskService.maskIsShown===e.value?(e.focus(),e.setSelectionRange(r,s)):e.selectionStart>this._maskService.actualValue.length&&e.setSelectionRange(this._maskService.actualValue.length,this._maskService.actualValue.length));let l=e&&(e.value===this._maskService.prefix?this._maskService.prefix+this._maskService.maskIsShown:e.value);if(e&&e.value!==l&&(e.value=l),e&&e.type!=="number"&&(e.selectionStart||e.selectionEnd)<=this._maskService.prefix.length){let u=this._maskService.maskExpression.match(new RegExp(`^[${this._maskService.specialCharacters.map(a=>`\\${a}`).join("")}]+`))?.[0].length||0;e.selectionStart=this._maskService.prefix.length+u;return}e&&e.selectionEnd>this._getActualInputLength()&&(e.selectionEnd=this._getActualInputLength())}onKeyDown(t){let e=t;if(!this._maskValue())return;if(this._isComposing()){e.key==="Enter"&&this.onCompositionEnd(t);return}this._code.set(e.code?e.code:e.key);let r=e.target;this._inputValue.set(r.value),this._setMask();let s=r.tagName.toLowerCase()==="textarea";if(r.type!=="number"){if(e.key===i.ARROW_UP&&!s&&e.preventDefault(),e.key===i.ARROW_LEFT||e.key===i.BACKSPACE||e.key===i.DELETE){if(e.key===i.BACKSPACE&&r.value.length===0&&(r.selectionStart=r.selectionEnd),e.key===i.BACKSPACE&&r.selectionStart!==0){let u=this.prefix().length,a=this.specialCharacters().length?this.specialCharacters():this._config.specialCharacters;if(u>1&&r.selectionStart<=u)r.setSelectionRange(u,r.selectionEnd);else if(this._inputValue().length!==r.selectionStart&&r.selectionStart!==1)for(;a.includes((this._inputValue()[r.selectionStart-1]??i.EMPTY_STRING).toString())&&(u>=1&&r.selectionStart>u||u===0);)r.setSelectionRange(r.selectionStart-1,r.selectionEnd)}this.checkSelectionOnDeletion(r),this._maskService.prefix.length&&r.selectionStart<=this._maskService.prefix.length&&r.selectionEnd<=this._maskService.prefix.length&&e.preventDefault();let l=r.selectionStart;e.key===i.BACKSPACE&&!r.readOnly&&l===0&&r.selectionEnd===r.value.length&&r.value.length!==0&&(this._position.set(this._maskService.prefix?this._maskService.prefix.length:0),this._maskService.applyMask(this._maskService.prefix,this._maskService.maskExpression,this._position()))}this.suffix()&&this.suffix().length>1&&this._inputValue().length-this.suffix().length<r.selectionStart?r.setSelectionRange(this._inputValue().length-this.suffix().length,this._inputValue().length):(e.code==="KeyA"&&e.ctrlKey||e.code==="KeyA"&&e.metaKey)&&(r.setSelectionRange(0,this._getActualInputLength()),e.preventDefault()),this._maskService.selStart=r.selectionStart,this._maskService.selEnd=r.selectionEnd}}async writeValue(t){let e=t,r=this._maskService.inputTransformFn;if(typeof e=="object"&&e!==null&&"value"in e&&("disable"in e&&this.setDisabledState(!!e.disable),e=e.value),e!==null&&(e=r?r(e):e),typeof e=="string"||typeof e=="number"||e===null||typeof e>"u"){(e===null||typeof e>"u"||e==="")&&(this._maskService.currentValue="",this._maskService.previousValue="");let s=e;if(typeof s=="number"||this._maskValue().startsWith(i.SEPARATOR)){s=String(s);let l=this._maskService.currentLocaleDecimalMarker();if(Array.isArray(this._maskService.decimalMarker)||(s=this._maskService.decimalMarker!==l?s.replace(l,this._maskService.decimalMarker):s),this._maskService.leadZero&&s&&this.mask()&&this.dropSpecialCharacters()!==!1&&(s=this._maskService._checkPrecision(this._maskService.maskExpression,s)),(this._maskService.decimalMarker===i.COMMA||Array.isArray(this._maskService.decimalMarker)&&this._maskService.thousandSeparator===i.DOT)&&(s=s.toString().replace(i.DOT,i.COMMA)),this.mask()?.startsWith(i.SEPARATOR)&&this.leadZero()){let u=!this._maskService.isInitialized;requestAnimationFrame(()=>{u&&(this._maskService.isInitialized=!1),this._maskService.applyMask(s?.toString()??"",this._maskService.maskExpression),u&&(this._maskService.isInitialized=!0)})}this._maskService.isNumberValue=!0}(typeof s!="string"||e===null||typeof e>"u")&&(s=""),this._inputValue.set(s),this._setMask(),s&&this._maskService.maskExpression||this._maskService.maskExpression&&(this._maskService.prefix||this._maskService.showMaskTyped)?(this._maskService.writingValue=!0,this._maskService.formElementProperty=["value",this._maskService.applyMask(s,this._maskService.maskExpression)],this._maskService.writingValue=!1,this._maskService.isInitialized=!0):(this._maskService.formElementProperty=["value",s],this._maskService.isInitialized=!0),this._inputValue.set(s)}else console.warn("Ngx-mask writeValue work with string | number, your current value:",typeof e)}registerOnChange(t){let e=t;this._maskService.onChange=this.onChange=r=>{if(e(r),this._isSignalFormsMode()){let s=r===null||typeof r>"u"?"":String(r);this.value()!==s&&this.value.set(s)}}}registerOnTouched(t){this.onTouch=()=>{t(),this._isSignalFormsMode()&&!this.touched()&&this.touched.set(!0)}}focus(){this._maskService._elementRef?.nativeElement?.focus()}_getActiveElement(t=this.document){let e=t?.activeElement?.shadowRoot;return e?.activeElement?this._getActiveElement(e):t.activeElement}checkSelectionOnDeletion(t){let e=this.prefix().length,r=this.suffix().length,s=this._inputValue().length;t.selectionStart=Math.min(Math.max(e,t.selectionStart),s-r),t.selectionEnd=Math.min(Math.max(e,t.selectionEnd),s-r)}setDisabledState(t){this._maskService.formElementProperty=["disabled",t]}_applyMask(){this._maskService.maskExpression=this._maskService._repeatPatternSymbols(this._maskValue()||""),this._maskService.formElementProperty=["value",this._maskService.applyMask(this._inputValue(),this._maskService.maskExpression)]}_validateTime(t){let e=this._maskValue().split(i.EMPTY_STRING).filter(r=>r!==":").length;return t&&(+(t[t.length-1]??-1)==0&&t.length<e||t.length<=e-2)?this._createValidationError(t):null}_getActualInputLength(){return this._maskService.actualValue.length||this._maskService.actualValue.length+this._maskService.prefix.length}_createValidationError(t){return{mask:{requiredMask:this._maskValue(),actualValue:t}}}_setMask(){this._maskExpressionArray().some(t=>{if(t.split(i.EMPTY_STRING).some(r=>this._maskService.specialCharacters.includes(r))&&this._inputValue()&&this._areAllCharactersInEachStringSame(this._maskExpressionArray())||t.includes(i.CURLY_BRACKETS_LEFT)){let r=this._maskService.removeMask(this._inputValue())?.length<=this._maskService.removeMask(t)?.length;if(r){let s=t.includes(i.CURLY_BRACKETS_LEFT)?this._maskService._repeatPatternSymbols(t):t;return this._maskValue.set(s),this._maskService.maskExpression=s,r}else{let s=this._maskExpressionArray()[this._maskExpressionArray().length-1]??i.EMPTY_STRING,l=s.includes(i.CURLY_BRACKETS_LEFT)?this._maskService._repeatPatternSymbols(s):s;this._maskValue.set(l),this._maskService.maskExpression=l}}else{let r=this._maskService.removeMask(t),s=this._maskService.removeMask(this._inputValue())?.split(i.EMPTY_STRING).every((l,u)=>{let a=r.charAt(u);return this._maskService._checkSymbolMask(l,a)});if(s||this._justPasted())return this._maskValue.set(t),this._maskService.maskExpression=t,s}})}_areAllCharactersInEachStringSame(t){let e=this._maskService.specialCharacters;function r(l){let u=new RegExp(`[${e.map(a=>`\\${a}`).join("")}]`,"g");return l.replace(u,"")}return t.map(r).every(l=>new Set(l).size===1)}static \u0275fac=function(e){return new(e||c)};static \u0275dir=le({type:c,selectors:[["input","mask",""],["textarea","mask",""]],hostBindings:function(e,r){e&1&&ce("paste",function(){return r.onPaste()})("focus",function(){return r.onFocus()})("ngModelChange",function(l){return r.onModelChange(l)})("input",function(l){return r.onInput(l)})("compositionstart",function(){return r.onCompositionStart()})("compositionend",function(l){return r.onCompositionEnd(l)})("blur",function(l){return r.onBlur(l)})("click",function(l){return r.onClick(l)})("keydown",function(l){return r.onKeyDown(l)})},inputs:{mask:[1,"mask"],specialCharacters:[1,"specialCharacters"],patterns:[1,"patterns"],prefix:[1,"prefix"],suffix:[1,"suffix"],thousandSeparator:[1,"thousandSeparator"],decimalMarker:[1,"decimalMarker"],dropSpecialCharacters:[1,"dropSpecialCharacters"],hiddenInput:[1,"hiddenInput"],showMaskTyped:[1,"showMaskTyped"],placeHolderCharacter:[1,"placeHolderCharacter"],shownMaskExpression:[1,"shownMaskExpression"],clearIfNotMatch:[1,"clearIfNotMatch"],validation:[1,"validation"],separatorLimit:[1,"separatorLimit"],allowNegativeNumbers:[1,"allowNegativeNumbers"],leadZeroDateTime:[1,"leadZeroDateTime"],leadZero:[1,"leadZero"],triggerOnMaskChange:[1,"triggerOnMaskChange"],apm:[1,"apm"],inputTransformFn:[1,"inputTransformFn"],outputTransformFn:[1,"outputTransformFn"],keepCharacterPositions:[1,"keepCharacterPositions"],instantPrefix:[1,"instantPrefix"],value:[1,"value"],errors:[1,"errors"],disabled:[1,"disabled"],touched:[1,"touched"],dirty:[1,"dirty"],invalid:[1,"invalid"],pending:[1,"pending"],readonly:[1,"readonly"],required:[1,"required"],name:[1,"name"]},outputs:{value:"valueChange",touched:"touchedChange",maskFilled:"maskFilled"},exportAs:["mask","ngxMask"],features:[oe([{provide:fe,useExisting:c,multi:!0},{provide:me,useExisting:c,multi:!0},K]),se]})}return c})(),Ye=(()=>{class c{defaultOptions=T(L);_maskService=T(K);_maskExpressionArray=[];mask="";transform(t,e,l={}){var u=l,{patterns:r}=u,s=te(u,["patterns"]);let a=t,h=ee(A(A({maskExpression:e},this.defaultOptions),s),{patterns:A(A({},this._maskService.patterns),r)});if(Object.entries(h).forEach(([m,p])=>{this._maskService[m]=p}),e.includes("||")){let m=e.split("||");return m.length>1?(this._maskExpressionArray=m.sort((p,_)=>p.length-_.length),this._setMask(`${a}`),this._maskService.applyMask(`${a}`,this.mask)):(this._maskExpressionArray=[],this._maskService.applyMask(`${a}`,this.mask))}if(e.includes(i.CURLY_BRACKETS_LEFT))return this._maskService.applyMask(`${a}`,this._maskService._repeatPatternSymbols(e));if(e.startsWith(i.SEPARATOR)){s.decimalMarker&&(this._maskService.decimalMarker=s.decimalMarker),s.thousandSeparator&&(this._maskService.thousandSeparator=s.thousandSeparator),s.leadZero&&(this._maskService.leadZero=s.leadZero),a=String(a);let m=this._maskService.currentLocaleDecimalMarker();Array.isArray(this._maskService.decimalMarker)||(a=this._maskService.decimalMarker!==m?a.replace(m,this._maskService.decimalMarker):a),this._maskService.leadZero&&a&&this._maskService.dropSpecialCharacters!==!1&&(a=this._maskService._checkPrecision(e,a)),this._maskService.decimalMarker===i.COMMA&&(a=a.replace(i.DOT,i.COMMA)),this._maskService.isNumberValue=!0}return a===null||typeof a>"u"?this._maskService.applyMask("",e):this._maskService.applyMask(`${a}`,e)}_setMask(t){this._maskExpressionArray.length>0&&this._maskExpressionArray.some(e=>{let r=this._maskService.removeMask(t)?.length<=this._maskService.removeMask(e)?.length;if(t&&r)return this.mask=e,r;this.mask=this._maskExpressionArray[this._maskExpressionArray.length-1]??i.EMPTY_STRING})}static \u0275fac=function(e){return new(e||c)};static \u0275pipe=he({name:"mask",type:c,pure:!0})}return c})();export{Ve as a,$e as b,Ye as c};
