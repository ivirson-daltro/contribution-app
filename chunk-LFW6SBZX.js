import{b as U}from"./chunk-EXFGMDDH.js";import{b as q}from"./chunk-VUMHNUOQ.js";import{a as H,b as L,d as J,e as K,f as Q,g as W}from"./chunk-67WNXVEK.js";import{c as I,e as h,g as A,h as F,l as R,n as $,o as w,p as z,q as B,r as k,s as j,u as G}from"./chunk-TP3L7WKP.js";import{a as V,b as Z}from"./chunk-AIT4FG67.js";import{$a as P,Ab as C,Da as f,E as M,Ia as _,Jb as S,Kb as D,R as v,W as p,Ya as y,_a as O,ab as c,bb as n,cb as e,db as a,gc as x,jb as u,nc as T,oc as N,uc as d,ya as l,yb as i,zb as E}from"./chunk-XFQJZCCP.js";var g=class m{httpClient=p(N);getMemberTypes(){return this.httpClient.get(`${d.apiUrl}/domain/member-types`)}getPaginatedMembers(t=1,o=10,r,b="asc"){let s=new T().set("page",t.toString()).set("limit",o.toString());return r&&(s=s.set("sortBy",r).set("sortDirection",b)),this.httpClient.get(`${d.apiUrl}/members/paginated`,{params:s})}saveMember(t){return this.httpClient.post(`${d.apiUrl}/members`,t)}getById(t){return this.httpClient.get(`${d.apiUrl}/members/${t}`)}getByName(t){return this.httpClient.get(`${d.apiUrl}/members/search?q=${t}`)}updateMember(t,o){return this.httpClient.put(`${d.apiUrl}/members/${t}`,o)}deleteMember(t){return this.httpClient.delete(`${d.apiUrl}/members/${t}`)}getAddressByZipCode(t){return this.httpClient.get(`https://viacep.com.br/ws/${t}/json/`)}static \u0275fac=function(o){return new(o||m)};static \u0275prov=v({token:m,factory:m.\u0275fac,providedIn:"root"})};function ee(m,t){if(m&1&&(n(0,"option",12),i(1),e()),m&2){let o=t.$implicit;c("value",o.id),l(),E(o.description)}}var X=class m{constructor(t,o,r){this.fb=t;this.dialogRef=o;this.data=r}membersService=p(g);toastService=p(q);form;memberTypes$=this.membersService.getMemberTypes();ngOnInit(){if(this.buildForm(),this.data){let t={id:this.data.id??"",name:this.data.name??"",memberTypeId:this.data.memberTypeId??null,memberType:this.data.memberType??null,phone:this.data.phone??void 0,email:this.data.email??void 0,genre:this.data.genre??void 0,birthDate:this.data.birthDate??void 0,entryDate:this.data.entryDate??void 0,baptismDate:this.data.baptismDate??void 0,zipCode:this.data.zipCode??void 0,street:this.data.street??void 0,number:this.data.number??void 0,complement:this.data.complement??void 0,city:this.data.city??void 0,state:this.data.state??void 0};this.data.memberType&&this.data.memberType.id&&(t.memberTypeId=this.data.memberType.id),this.form.patchValue(t)}}buildForm(){this.form=this.fb.group({name:[null,h.required],memberTypeId:[null,h.required],phone:[null],email:[null],genre:[null],birthDate:[null],entryDate:[null],baptismDate:[null],zipCode:[null],street:[null],number:[null],complement:[null],city:[null],state:[null]})}submit(){let t=this.form.getRawValue();this.data&&this.data.id?this.updateMember(this.data.id,t):this.saveMember(t)}saveMember(t){this.membersService.saveMember(t).pipe(M()).subscribe({next:()=>{this.dialogRef.close(!0),this.toastService.success("Membro cadastrado com sucesso.")},error:o=>{this.toastService.error(o?.error?.error??"Erro ao cadastrar membro.")}})}updateMember(t,o){this.membersService.updateMember(t,o).pipe(M()).subscribe({next:()=>{this.dialogRef.close(!0),this.toastService.success("Membro atualizado com sucesso.")},error:r=>{this.toastService.error(r?.error?.error??"Erro ao atualizar membro.")}})}onZipCodeChange(t){let r=t.target.value;r&&r.length===9&&this.getAddressByZipCode(r)}getAddressByZipCode(t){this.membersService.getAddressByZipCode(t).subscribe({next:o=>{this.form.patchValue({street:o.logradouro,complement:o.complemento,city:o.localidade,state:o.uf})},error:()=>{this.toastService.warning("Endere\xE7o n\xE3o encontrado para o CEP informado.")}})}close(){this.dialogRef.close()}static \u0275fac=function(o){return new(o||m)(f(j),f(H),f(L))};static \u0275cmp=_({type:m,selectors:[["app-add-members"]],decls:95,vars:8,consts:[[1,"cadastrar-container"],[1,"cadastrar-card"],["mat-dialog-title","",1,"card-title"],[1,"contribution-form",3,"ngSubmit","formGroup"],[1,"row","mb-3"],[1,"col-12","col-lg-8"],["for","name",1,"form-label"],["formControlName","name","placeholder","Digite o nome",1,"form-control"],[1,"col-12","col-lg-4"],["for","memberTypeId",1,"form-label"],["formControlName","memberTypeId",1,"form-control"],["disabled","","selected","",3,"value"],[3,"value"],["for","phone",1,"form-label"],["formControlName","phone","placeholder","Digite o telefone","mask","(00) 0 0000-0000",1,"form-control"],["for","email",1,"form-label"],["formControlName","email","placeholder","Digite o e-mail",1,"form-control"],["for","genre",1,"form-label"],["formControlName","genre",1,"form-control"],["value","Masculino"],["value","Feminino"],["for","birthDate",1,"form-label"],["type","date","formControlName","birthDate",1,"form-control"],["for","entryDate",1,"form-label"],["type","date","formControlName","entryDate",1,"form-control"],["for","baptismDate",1,"form-label"],["type","date","formControlName","baptismDate",1,"form-control"],[1,"col-12","col-lg-3"],["for","zipCode",1,"form-label"],["formControlName","zipCode","placeholder","Digite o CEP","mask","00000-000",1,"form-control",3,"change"],[1,"col-12","col-lg-6"],["for","street",1,"form-label"],["formControlName","street","placeholder","Digite a rua",1,"form-control"],["for","number",1,"form-label"],["formControlName","number","placeholder","Digite o n\xFAmero",1,"form-control"],[1,"col-12"],["for","complement",1,"form-label"],["formControlName","complement","placeholder","Digite o complemento",1,"form-control"],["for","city",1,"form-label"],["formControlName","city","placeholder","Digite a cidade",1,"form-control"],["for","state",1,"form-label"],["formControlName","state","placeholder","Digite o estado",1,"form-control"],["align","end",1,"form-footer"],["type","button",1,"btn","cancel-button",3,"click"],["type","submit",1,"btn","btn-primary","submit-button",3,"disabled"],["fontIcon","save",1,"submit-icon"]],template:function(o,r){o&1&&(n(0,"div",0)(1,"div",1)(2,"h2",2),i(3),e(),n(4,"form",3),u("ngSubmit",function(){return r.submit()}),n(5,"mat-dialog-content")(6,"fieldset")(7,"legend"),i(8,"Informa\xE7\xF5es Pessoais"),e(),n(9,"div",4)(10,"div",5)(11,"label",6),i(12,"Nome"),e(),a(13,"input",7),e(),n(14,"div",8)(15,"label",9),i(16,"Tipo de Membro"),e(),n(17,"select",10)(18,"option",11),i(19,"- Selecione"),e(),O(20,ee,2,2,"option",12,y),S(22,"async"),e()()(),n(23,"div",4)(24,"div",8)(25,"label",13),i(26,"Telefone"),e(),a(27,"input",14),e(),n(28,"div",5)(29,"label",15),i(30,"E-mail"),e(),a(31,"input",16),e()(),n(32,"div",4)(33,"div",8)(34,"label",17),i(35,"G\xEAnero"),e(),n(36,"select",18)(37,"option",11),i(38,"- Selecione"),e(),n(39,"option",19),i(40,"Masculino"),e(),n(41,"option",20),i(42,"Feminino"),e()()(),n(43,"div",8)(44,"label",21),i(45,"Data de Nascimento"),e(),a(46,"input",22),e()()(),n(47,"fieldset")(48,"legend"),i(49,"Dados de membresia"),e(),n(50,"div",4)(51,"div",8)(52,"label",23),i(53,"Data de Entrada"),e(),a(54,"input",24),e(),n(55,"div",8)(56,"label",25),i(57,"Data de Batismo"),e(),a(58,"input",26),e()()(),n(59,"fieldset")(60,"legend"),i(61,"Dados de Endere\xE7o"),e(),n(62,"div",4)(63,"div",27)(64,"label",28),i(65,"CEP"),e(),n(66,"input",29),u("change",function(s){return r.onZipCodeChange(s)}),e()(),n(67,"div",30)(68,"label",31),i(69,"Rua"),e(),a(70,"input",32),e(),n(71,"div",27)(72,"label",33),i(73,"N\xFAmero"),e(),a(74,"input",34),e()(),n(75,"div",4)(76,"div",35)(77,"label",36),i(78,"Complemento"),e(),a(79,"input",37),e()(),n(80,"div",4)(81,"div",8)(82,"label",38),i(83,"Cidade"),e(),a(84,"input",39),e(),n(85,"div",8)(86,"label",40),i(87,"Estado"),e(),a(88,"input",41),e()()()(),n(89,"mat-dialog-actions",42)(90,"button",43),u("click",function(){return r.close()}),i(91,"Cancelar"),e(),n(92,"button",44),a(93,"mat-icon",45),i(94),e()()()()()),o&2&&(l(3),C("",r.data?"Atualizar":"Novo"," Membro"),l(),c("formGroup",r.form),l(14),c("value",null),l(2),P(D(22,6,r.memberTypes$)),l(17),c("value",null),l(55),c("disabled",r.form.invalid),l(2),C(" ",r.data?"Atualizar":"Cadastrar"," Membro "))},dependencies:[G,R,B,k,I,z,A,F,w,$,W,J,Q,K,Z,V,U,x],styles:[".cadastrar-container[_ngcontent-%COMP%]   .card-title[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:700;color:#0b2454}.cadastrar-container[_ngcontent-%COMP%]   .contribution-form[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]{display:block;font-size:.85rem;font-weight:600;margin-bottom:.35rem;color:#374151}.cadastrar-container[_ngcontent-%COMP%]   .contribution-form[_ngcontent-%COMP%]   .mat-mdc-form-field[_ngcontent-%COMP%]{width:100%}.cadastrar-container[_ngcontent-%COMP%]   .contribution-form[_ngcontent-%COMP%]   .mat-mdc-text-field-wrapper[_ngcontent-%COMP%]{background-color:#f7f9fc;border-radius:.75rem}.cadastrar-container[_ngcontent-%COMP%]   .contribution-form[_ngcontent-%COMP%]   .mat-mdc-form-field-appearance-outline[_ngcontent-%COMP%]   .mdc-notched-outline__leading[_ngcontent-%COMP%], .cadastrar-container[_ngcontent-%COMP%]   .contribution-form[_ngcontent-%COMP%]   .mat-mdc-form-field-appearance-outline[_ngcontent-%COMP%]   .mdc-notched-outline__notch[_ngcontent-%COMP%], .cadastrar-container[_ngcontent-%COMP%]   .contribution-form[_ngcontent-%COMP%]   .mat-mdc-form-field-appearance-outline[_ngcontent-%COMP%]   .mdc-notched-outline__trailing[_ngcontent-%COMP%]{border-color:#d1d5db}.cadastrar-container[_ngcontent-%COMP%]   .contribution-form[_ngcontent-%COMP%]   .mat-mdc-form-field.mat-focused[_ngcontent-%COMP%]   .mdc-notched-outline__leading[_ngcontent-%COMP%], .cadastrar-container[_ngcontent-%COMP%]   .contribution-form[_ngcontent-%COMP%]   .mat-mdc-form-field.mat-focused[_ngcontent-%COMP%]   .mdc-notched-outline__notch[_ngcontent-%COMP%], .cadastrar-container[_ngcontent-%COMP%]   .contribution-form[_ngcontent-%COMP%]   .mat-mdc-form-field.mat-focused[_ngcontent-%COMP%]   .mdc-notched-outline__trailing[_ngcontent-%COMP%]{border-color:#1d4ed8}.cadastrar-container[_ngcontent-%COMP%]   .contribution-form[_ngcontent-%COMP%]   .form-footer[_ngcontent-%COMP%]{margin-top:1.5rem;padding-top:1rem;border-top:1px solid #e5e7eb;display:flex;gap:1rem;align-items:center}.cadastrar-container[_ngcontent-%COMP%]   .contribution-form[_ngcontent-%COMP%]   .cancel-button[_ngcontent-%COMP%]{color:#6b7280}.cadastrar-container[_ngcontent-%COMP%]   .contribution-form[_ngcontent-%COMP%]   .submit-button[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;gap:.5rem;height:3rem;border-radius:.625rem;background-color:#0b2454;font-weight:600}fieldset[_ngcontent-%COMP%]{border:1px solid #d1d5db;border-radius:.625rem;padding:1rem;margin-bottom:1.5rem}fieldset[_ngcontent-%COMP%]   legend[_ngcontent-%COMP%]{margin-bottom:1rem;font-weight:600;color:#374151}@media(max-width:600px){.cadastrar-card[_ngcontent-%COMP%]{padding:1.25rem 1.25rem 1.75rem}}"]})};export{g as a,X as b};
